<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Game Đua Xe</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.3.3/pixi.min.js"></script>
  <script>
    // Khởi tạo PixiJS
    const app = new PIXI.Application({ width: window.innerWidth, height: window.innerHeight });
    document.body.appendChild(app.view);

    // Tạo đường đua và xe
    let track;
    let car;

    // Tải các tài nguyên
    app.loader.add('track', 'data/track.png')
              .add('car', 'data/car.png')
              .load(setup);

    function setup() {
      // Tạo đường đua
      track = new PIXI.Sprite(app.loader.resources['track'].texture);
      track.width = app.renderer.width;
      track.height = app.renderer.height;
      app.stage.addChild(track);

      // Tạo xe
      car = new PIXI.Sprite(app.loader.resources['car'].texture);
      car.position.set(app.renderer.width / 2, app.renderer.height - 50);
      car.anchor.set(0.5);
      app.stage.addChild(car);

      // Bắt đầu vòng lặp chính
      app.ticker.add(gameLoop);

      // Bắt sự kiện bàn phím
      document.addEventListener('keydown', onKeyDown);
      document.addEventListener('keyup', onKeyUp);

      // Bắt sự kiện chuột
      app.view.addEventListener('mousemove', onMouseMove);
    }

    let isLeftKeyDown = false;
    let isRightKeyDown = false;

    function onKeyDown(event) {
      if (event.key === 'ArrowLeft') {
        isLeftKeyDown = true;
      } else if (event.key === 'ArrowRight') {
        isRightKeyDown = true;
      }
    }

    function onKeyUp(event) {
      if (event.key === 'ArrowLeft') {
        isLeftKeyDown = false;
      } else if (event.key === 'ArrowRight') {
        isRightKeyDown = false;
      }
    }

    function onMouseMove(event) {
      const mouseX = event.clientX;
      const carX = mouseX - app.view.offsetLeft;

      car.x = carX;
    }

    function gameLoop(delta) {
      // Di chuyển xe dựa trên sự kiện bàn phím
      if (isLeftKeyDown) {
        car.x -= delta * 5;
      } else if (isRightKeyDown) {
        car.x += delta * 5;
      }

      // Giới hạn di chuyển của xe trong phạm vi đường đua
      if (car.x < 0) {
        car.x = 0;
      } else if (car.x > app.renderer.width) {
        car.x = app.renderer.width;
      }
    }
  </script>
</body>
</html>
